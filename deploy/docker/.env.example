# Copy to `.env` and adjust before starting the stack.

# --- Mortimer Flask configuration ---
MORTIMER_SECRET_KEY=
MORTIMER_PAROLE=
ADMIN_MAIL=

# --- MongoDB bootstrap credentials (entrypoint) ---
MONGO_INITDB_ROOT_USERNAME=
MONGO_INITDB_ROOT_PASSWORD=
MONGO_INITDB_DATABASE=mortimer

# --- Mortimer application Mongo credentials ---
MORTIMER_MONGO_USERNAME=
MORTIMER_MONGO_PASSWORD=
MORTIMER_MONGO_HOST=mortimer-mongo
MORTIMER_MONGO_PORT=27017
MORTIMER_MONGO_DB=mortimer
MORTIMER_MONGO_AUTH_SOURCE=mortimer
MORTIMER_MONGO_SSL=false
ALFRED_DB_NAME=alfred

ALFRED_CONFIG_FILE=/app/config/alfred.conf
ALFRED_LOGFILE=/app/log/alfred.log

# Gunicorn defaults (override if you externalise experiment sessions)
WEB_CONCURRENCY=1
GUNICORN_THREADS=10

# Mortimer mail settings
MORTIMER_MAIL_USE=False
MORTIMER_MAIL_SERVER=
MORTIMER_MAIL_PORT=
MORTIMER_MAIL_USE_TLS=True
MORTIMER_MAIL_USERNAME=
MORTIMER_MAIL_PASSWORD=
MORTIMER_MAIL_SENDER_ADDRESS=

# ---------- NGINX / TLS ----------
# Domain/FQDN (required when TLS_MODE=letsencrypt)
SERVER_NAME=example.org

# TLS mode: letsencrypt | off
TLS_MODE=letsencrypt

# Cert paths (only used when TLS_MODE=letsencrypt)
SSL_FULLCHAIN_PATH=/etc/letsencrypt/live/${SERVER_NAME}/fullchain.pem
SSL_PRIVKEY_PATH=/etc/letsencrypt/live/${SERVER_NAME}/privkey.pem

# One or many ports for multiple Gunicorn instances (8001 is mandatory, 8012 is max)
APP_PORTS="8001 8002"

# List of Mortimer app backends (host:port) to load balance across.
# Must match the ports your Gunicorn instances are listening on.
UPSTREAM_BACKENDS="mortimer-app:8001 mortimer-app:8002"

# ---------- Optional tuning (has defaults; override when needed) ----------
CLIENT_MAX_BODY_SIZE=20m      # max upload size
PROXY_READ_TIMEOUT=75s        # upstream read timeout
PROXY_SEND_TIMEOUT=75s        # upstream send timeout
PROXY_CONNECT_TIMEOUT=5s      # upstream connect timeout
PROXY_BUFFERING=on            # on for typical APIs, off for streaming
RATE_LIMIT_REQS=10            # requests per second per IP
RATE_LIMIT_BURST=20           # burst allowance
LOG_FORMAT=json               # default | json
ENABLE_WEBSOCKETS=false       # set true if your app uses WS
